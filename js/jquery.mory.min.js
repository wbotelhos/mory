/*!
 * jQuery Mory - A Read More Plugin
 *
 * Licensed under The MIT License
 *
 * @version        0.1.0
 * @author         Washington Botelho
 * @documentation  wbotelhos.com/mory
 * 
 */

;(function(b){var a={init:function(c){return this.each(function(){var e=b.extend({},b.fn.mory.defaults,c),k=b(this),m=b.trim(k.html());if(m.length<=e.number||k.data("mory")){return;}k.data({options:e,mory:true});var h=a.getLength.call(k,m),f=m.slice(0,h);m=m.slice(h);var l=b("<span/>",{"class":"mory-resume",html:f}),d=b("<span/>",{"class":"mory-content",html:m}).hide(),g=b("<span/>",{"class":"mory-reticence"}),j=b("<a/>",{"class":"mory-link",href:"javascript:void(0);",title:e.expandText,html:e.expandText}),i=b("<span/>",{"class":"mory-more"}).append(j).wrap("<span/>");if(e.reticence){g.html(e.reticence.replace(" ","&#160;"));}else{g.html("&#160;");}k.html(l).append(d,g,i);a.bindAction.call(k);});},bindAction:function(){var c=this,e=c.data("options"),g=c.children(".mory-resume"),d=c.children(".mory-content"),f=c.children(".mory-reticence");$link=c.find(".mory-link");c.find(".mory-link").toggle(function(){b(this).html(e.collapseText);if(e.expandEffect=="fadein"){d.css({display:"inline",opacity:"0"}).stop().animate({opacity:100},e.expandSpeed);}else{d.css("display","inline");}$link.attr("title",e.collapseText);f.html("&#160;");},function(){b(this).html(e.expandText);if(e.collapseEffect=="fadeout"){d.stop().animate({opacity:0},e.collapseSpeed,function(){b(this).hide();g.css("display","inline");});}else{d.hide();}$link.attr("title",e.expandText);f.html(e.reticence);});},getLength:function(g){var d=this.data("options"),c=g.match(d.openTag),f=g.match(d.closeTag),h=g.match(d.singleTag);var e=(c&&c.join("").length||0)+(f&&f.join("").length||0)+(h&&h.join("").length||0);return d.number+e;}};b.fn.mory=function(c){if(a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1));}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments);}else{b.error("Method "+c+" does not exist!");}}};b.fn.mory.defaults={collapseEffect:undefined,collapseSpeed:150,collapseText:"read less",expandEffect:undefined,expandSpeed:2000,expandText:"read more",number:140,reticence:"... ",openTag:/<(\w+)[^>]*>/g,closeTag:/<\/(\w+)>/g,singleTag:/<(\w+)(\s*)\/>/g};})(jQuery);
